<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>TE3201 Programming Basics: Appendix B: Unit Testing</title>
    <link rel="stylesheet" href="..\..\markbind\css\bootstrap.min.css">
    <link rel="stylesheet" href="..\..\markbind\css\github.min.css">
    <link rel="stylesheet" href="..\..\markbind\css\markbind.css">
</head>
<body>
<div id="app" class="container-fluid">
    <link rel="stylesheet" href="/website/programming/css/programming.css">
<div class="website-content">
  <div id="toc">
    <p><span style="float:right"><a href="../index.html"><span class="glyphicon glyphicon-home" aria-hidden="true"></span> â†‘</a>
      </span>
    </p>
  </div>
  <div id="main">
    <div>
      <h1 id="appendix-b-unit-testing">Appendix B: Unit Testing</h1>
      <p>The built-in module <code>unittest</code> supports automation of unit testing in an object-oriented way.</p>
      <p>Let's assume you have a file called <code>search.py</code> which has the following two functions.</p>
      <pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_first_name</span><span class="hljs-params">(name)</span>:</span>
  <span class="hljs-string">"""Return the first part of the parameter 'name'"""</span>
  <span class="hljs-keyword">return</span> name.split()[<span class="hljs-number">0</span>]


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_same_person</span><span class="hljs-params">(person, keyword)</span>:</span>
  <span class="hljs-string">"""Return True if the parameter 'person' (type: dictionary)
  contains a key 'name' whose value contains the 
  parameter 'keyword' (type: string)
  e.g., 
  * is_same_person({'name': 'jackie'}, 'jack') returns True
  * is_same_person({'name': 'jackie'}, 'jackie-chan') returns False
  """</span>
  <span class="hljs-keyword">return</span> keyword <span class="hljs-keyword">in</span> person[<span class="hljs-string">'name'</span>]
</code></pre>
      <p>This is how we can write some unit tests for the two functions.</p>
      <pre><code class="hljs python"><span class="hljs-keyword">import</span> search, unittest

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestSearch</span><span class="hljs-params">(unittest.TestCase)</span>:</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_is_same_person</span><span class="hljs-params">(self)</span>:</span>
    jack = {<span class="hljs-string">'name'</span>:<span class="hljs-string">'jack'</span>}
    self.assertTrue(search.is_same_person(jack, <span class="hljs-string">'jack'</span>))
    self.assertTrue(search.is_same_person(jack, <span class="hljs-string">'ack'</span>))
    self.assertTrue(search.is_same_person(jack, <span class="hljs-string">'ac'</span>))
    self.assertTrue(search.is_same_person(jack, <span class="hljs-string">'j'</span>))
    self.assertTrue(search.is_same_person(jack, <span class="hljs-string">'k'</span>))
    self.assertFalse(search.is_same_person(jack, <span class="hljs-string">'jackie'</span>))
    self.assertFalse(search.is_same_person(jack, <span class="hljs-string">'blackjack'</span>))
    self.assertFalse(search.is_same_person({<span class="hljs-string">'name'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'other'</span>: <span class="hljs-string">'jack'</span>}, <span class="hljs-string">'jack'</span>))
    <span class="hljs-keyword">with</span> self.assertRaises(KeyError):
      search.is_same_person({}, <span class="hljs-string">'jack'</span>)
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_get_first_name</span><span class="hljs-params">(self)</span>:</span>
    self.assertEqual(search.get_first_name(<span class="hljs-string">'Amy'</span>), <span class="hljs-string">'Amy'</span>)
    self.assertEqual(search.get_first_name(<span class="hljs-string">'Amy Bernice'</span>), <span class="hljs-string">'Amy'</span>)
    self.assertEqual(search.get_first_name(<span class="hljs-string">'Amy-Bernice'</span>), <span class="hljs-string">'Amy-Bernice'</span>)
    <span class="hljs-keyword">with</span> self.assertRaises(IndexError):
      search.get_first_name(<span class="hljs-string">''</span>)

<span class="hljs-comment"># activate the test runner      </span>
unittest.main()
</code></pre>
      <p>When you run the above code, each method in the test class will be executed by a built-in <em>test runner</em> and the result will be reported. An example is given below:</p>
      <pre class="hljs"><code>...
----------------------------------------------------------------------
Ran 2 tests in 0.019s

OK
</code></pre>
      <p>Things to note:</p>
      <ul>
        <li>A class containing unit tests should inherit from <code>unittest.TestCase</code></li>
        <li>Names of functions containing test code should start with <code>test</code> e.g., <code>test_is_same_person()</code></li>
        <li>These methods (inherited from the parent class) can be used to compare actual with the expected value:
          <ul>
            <li><code>assertTrue(actual)</code> : test passes if <code>actual == True</code></li>
            <li><code>assertFalse(actual)</code> : test passes if <code>actual == False</code></li>
            <li><code>assertEquals(actual, expected)</code> : test passes if <code>actual == expected</code></li>
            <li><code>with self.assertRaises(Exception):</code> passes if the code block it contains raises the specified exception.</li>
          </ul>
        </li>
      </ul>
      <p>If the expected value is not as same as the actual, the test runner will report the test failure. For example, if we were to insert this statement into <code>test_get_first_name</code> method,</p>
      <pre><code class="hljs python">self.assertEqual(search.get_first_name(<span class="hljs-string">'Amy Foo'</span>), <span class="hljs-string">'Foo'</span>)
</code></pre>
      <p>the output will be something like this:</p>
      <pre class="hljs"><code>F.
======================================================================
FAIL: test_get_first_name (__main__.TestSearch)
----------------------------------------------------------------------
Traceback (most recent call last):
  File &quot;main.py&quot;, line 19, in test_get_first_name
    self.assertEqual(search.get_first_name('Amy Foo'), 'Foo')
AssertionError: 'Amy' != 'Foo'
- Amy
+ Foo


----------------------------------------------------------------------
Ran 2 tests in 0.001s

FAILED (failures=1)
</code></pre>
      <p>ðŸ“Ž Resources:</p>
      <ul>
        <li>More on unit testing: <a href="https://docs.python.org/3/library/unittest.html">https://docs.python.org/3/library/unittest.html</a></li>
        <li>Unit testing in the PyCharm IDE: <a href="https://www.youtube.com/watch?v=-VzJvNLooj4">https://www.youtube.com/watch?v=-VzJvNLooj4</a></li>
      </ul>
    </div>
    <hr>
    <hr>
  </div>
</div>
</div>
</body>
<script src="..\..\markbind\js\vue.min.js"></script>
<script src="..\..\markbind\js\vue-strap.min.js"></script>
<script src="..\..\markbind\js\setup.js"></script>
</html>
